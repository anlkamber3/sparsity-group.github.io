<!DOCTYPE html> <html> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta name="google-site-verification" content="AncIbi6WH1u-WTOqfFH_ifUv8WbpzIVWNvrT_GjQ9vk"> <meta http-equiv="Permissions-Policy" content="interest-cohort=()"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Surprising Properties of Two-Hidden Layer Neural Networks | SPARSITY @ UCSD </title> <meta name="author" content="Rahul Parhi"> <meta name="description" content="put a witty website description here later "> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/favicon.ico?2c1bcb873573b3573b8097882b5c68c9"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://sparsity.ucsd.edu/posts/2020/surprising-properties-two-hidden-layer-neural-networks/"> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script src="/assets/js/distillpub/template.v2.js"></script> <script src="/assets/js/distillpub/transforms.v2.js"></script> <script src="/assets/js/distillpub/overrides.js"></script> </head> <body> <d-front-matter> <script async type="text/json">
      {
            "title": "Surprising Properties of Two-Hidden Layer Neural Networks",
            "description": "",
            "published": "August 21, 2020",
            "authors": [
              
              {
                "author": "Rahul Parhi",
                "authorURL": "",
                "affiliations": [
                  {
                    "name": "University of Wisconsin--Madison",
                    "url": ""
                  }
                ]
              }
              
            ],
            "katex": {
              "delimiters": [
                {
                  "left": "$",
                  "right": "$",
                  "display": false
                },
                {
                  "left": "$$",
                  "right": "$$",
                  "display": true
                }
              ]
            }
          }
    </script> </d-front-matter> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <img height="25px" src="/assets/img/logo.svg" alt="SPARSITY @ UCSD"> </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">Home </a> </li> <li class="nav-item "> <a class="nav-link" href="/people/">People </a> </li> <li class="nav-item "> <a class="nav-link" href="/papers/">Papers </a> </li> <li class="nav-item active"> <a class="nav-link" href="/posts/">Posts </a> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">Teaching </a> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="post distill"> <d-title> <h1>Surprising Properties of Two-Hidden Layer Neural Networks</h1> <p></p> </d-title> <d-byline></d-byline> <d-article> <h2 id="introduction">Introduction</h2> <p>Neural networks, particularly <em>deep</em> neural networks, are extremely popular in modern machine learning due to their seemingly “magical” properties. The usual heuristic for explaining why neural networks work is that they are <em>universal approximators</em>, though we remark that universal approximation is a rather boring result and is easily achieved by any sufficiently nice class of functions. For more information why universal approximation is rather boring, see the entire field of approximation theory.</p> <p>The well-known universal approximation theorem has been studied by a number of authors and considers single-hidden layer neural networks of the form</p> \[\mathbf{x} \mapsto \sum_{k=1}^K v_k \, \rho(\mathbf{w}_k^\mathsf{T} \mathbf{x} - b_k), \tag{1}\] <p>where \(\rho: \mathbb{R} \to \mathbb{R}\) is a fixed <em>activation function</em> and, for \(k = 1, \ldots K\), \(v_k \in \mathbb{R}\) and \(\mathbf{w}_k \in \mathbb{R}^d\) are the <em>weights</em> of the network and \(b_k \in \mathbb{R}\) are the <em>biases</em> of the network. The universal approximation theorem then says that just about any choice of activation function \(\rho\), one can <em>uniformly</em> approximate arbitrarily well any given continuous function with functions of the form in \((1)\). It is important to note that this result does not assume that the width \(K\) is fixed, i.e., \(K\) can be (and must be) arbitrarily large. In other words, there does not exist a fixed \(K\) such that every continuous function can be uniformly approximated by functions of the form in \((1)\). In fact, the universal approximation property cannot hold if \(K\) is fixed, even if we allow \(\rho\) to be tunable over all continuous functions. This fundamental fact regarding single-hidden layer networks can be seen in Theorem 5.1 of <d-cite key="lin1993fundamentality"></d-cite>.</p> <p>What is surprising is that this negative property of single-hidden layer neural networks does not carry over to the two-hidden layer case. Indeed, with two-hidden layers, there exists an activation function \(\rho\) and a network width proportional to the input dimension such that any continuous function defined on a compact domain can be uniformly approximated by a two-hidden layer network of this width.</p> <p>This result was proved in Theorem 5 of <d-cite key="maiorov1999lower"></d-cite>. In this post we will prove this result and discuss its implications to statistical learning. In particular, we will use this result to show that there exist finite-parameter neural networks with infinite <a href="https://en.wikipedia.org/wiki/Vapnik%E2%80%93Chervonenkis_dimension" rel="external nofollow noopener" target="_blank">Vapnik–Chervonenkis (VC) dimension</a>. This result provides a new example to the well-known fact that the VC-dimension of a parameterized hypothesis space is not upper-bounded by the dimension of the parameter space.</p> <h2 id="universal-approximation">Universal approximation</h2> <p>The most general version of the universal approximation theorem is due to Leshno, Lin, Pinkus, and Schocken in 1993<d-cite key="leshno1993multilayer"></d-cite>.</p> <p><strong>Proposition 1 (Theorem 1 of <d-cite key="leshno1993multilayer"></d-cite>).</strong> Let \(\rho: \mathbb{R} \to \mathbb{R}\) be any continuous function and let \(\Omega \subset \mathbb{R}^d\) be compact. Then, the set</p> \[\mathsf{1NN}_\rho := \textrm{span}\{\mathbf{x} \mapsto \rho(\mathbf{w}^\mathsf{T} \mathbf{x} - b) \: : \: \mathbf{w} \in \mathbb{R}^d, b \in \mathbb{R}\}\] <p>is dense (with respect to the uniform norm) in \(C(\Omega)\), the space of continuous functions on \(\Omega\), if and only if \(\rho\) is not an algebraic polynomial.</p> <p>As discussed in the <a href="#introduction">Introduction</a>, Theorem 5.1 of <d-cite key="lin1993fundamentality"></d-cite> says that if we let \(K \in \mathbb{N}\) be fixed and consider the set</p> \[\mathsf{1NN}_\rho^K := \left\{ \mathbf{x} \mapsto \sum_{k=1}^K v_k \, \rho(\mathbf{w}_k^\mathsf{T} \mathbf{x} - b_k) \: : \: v_k \in \mathbb{R}, \mathbf{w}_k \in \mathbb{R}^d, b_k \in \mathbb{R} \right\}\] <p>or the set</p> \[\mathsf{1NN}^K := \left\{ \mathbf{x} \mapsto \sum_{k=1}^K v_k \, \rho(\mathbf{w}_k^\mathsf{T} \mathbf{x} - b_k) \: : \: v_k \in \mathbb{R}, \mathbf{w}_k \in \mathbb{R}^d, b_k \in \mathbb{R}, \rho \in C(\mathbb{R}) \right\},\] <p>then, neither \(\mathsf{1NN}_\rho^K\) nor \(\mathsf{1NN}^K\) is dense in \(C(\Omega)\), where \(\Omega \subset \mathbb{R}^d\) is compact.</p> <p>Theorem 5 of <d-cite key="maiorov1999lower"></d-cite> considers the set of two-hidden layer neural networks with fixed hidden layer widths</p> \[\mathsf{2NN}_\rho^{K_1, K_2} := \left\{\mathbf{x} \mapsto \sum_{k=1}^{K_2} u_k \rho\left(\sum_{\ell = 1}^{K_1} v_{k\ell}\, \rho(\mathbf{w}_{k\ell}^\mathsf{T}\mathbf{x} - b_{k\ell}) - c_k\right) \: : \: u_k \in \mathbb{R}, v_{k\ell} \in \mathbb{R}, \mathbf{w}_{k\ell} \in \mathbb{R}^d, b_{k\ell} \in \mathbb{R}, c_k \in \mathbb{R}\right\}.\] <p>In particular, \(K_1\) and \(K_2\) are both \(O(d)\). The main idea is that \(\rho\) in the above display is a specially constructed activation function. Theorem 5 of <d-cite key="maiorov1999lower"></d-cite> then says \(\mathsf{2NN}_\rho^{K_1, K_2}\) is dense in \(C(\Omega)\). Before proving this result, we remark that there are two key ingredients to the proof. The first is the seperability of the metric space \(C(\Omega)\) when equipped with the uniform norm as the metric. The second is the Kolmogorov superposition theorem<d-cite key="kolmogorov1956representation"></d-cite>. We will first recall this theorem.</p> <p><strong>Proposition 2 (Kolmogorov Superposition Theorem<d-cite key="kolmogorov1956representation"></d-cite>).</strong> Let \(d \geq 2\). Then, there exist constants \(\lambda_q &gt; 0\), \(q = 1, \ldots, d\), and continuous functions \(\phi_q: [0, 1] \to [0, 1]\), \(p = 1, \ldots, 2d + 1\), such that every continuous function \(f: [0, 1]^d \mapsto \mathbb{R}\) admits the representation</p> \[f(\mathbf{x}) = f(x_1, \ldots, x_d) = \sum_{p=1}^{2d + 1} g \left(\sum_{q=1}^d \lambda_q \phi_q(x_q)\right), \tag{2}\] <p>for some \(g \in C[0, 1]\) depending on \(f\).</p> <p>We will now prove the main result.</p> <p><strong>Theorem 1 (Similar to Theorem 5 of <d-cite key="maiorov1999lower"></d-cite>).</strong> Let \(\Omega \subset \mathbb{R}^d\) be compact. There exists \(K_1\) and \(K_2\) being \(O(d)\) and \(\rho: \mathbb{R} \to \mathbb{R}\) such that \(\mathsf{2NN}_\rho^{K_1, K_2}\) is dense (with respect to the uniform norm) in \(C(\Omega)\). In other words, given \(\varepsilon &gt; 0\), for every \(f \in C(\Omega)\), there exists a two-hidden layer neural network \(h \in \mathsf{2NN}_\rho^{K_1, K_2}\) such that</p> \[\lVert f - h \rVert_{L^\infty(\Omega)} &lt; \varepsilon\] <p>In particular, \(K_1 = d\) and \(K_2 = 2d + 1\).</p> <p><em>Proof.</em> It suffices to prove the result for \(\Omega = [0,1]^d\) since the general result then follows by translating and dilating. The main idea is to construct \(\rho\) in a special manner so that there exist weights and biases so that the terms that appear in the Kolmogorov superposition theorem in \((2)\) can be uniformly approximated by the activation function. The construction relies on the fact that \(C[0,1]\) is seperable. Indeed, let \({p<em>n}</em>{n \in \mathbb{Z}}\) be an enumeration of any countable dense subset of \(C[0,1]\), say, polynomials with rational coefficients. Then, define \(\rho\) so that for every \(n \in \mathbb{Z}\),</p> \[\rho(x) = p_n(x - n), \quad x \in [n, n + 1]\] <p>i.e., on each interval \([n, n + 1]\), \(\rho\) is a polynomial with rational coefficients. The main idea with this construction is that we have “encoded” every single polynomial with rational coefficients within \(\rho\).</p> <p>The theorem follows immediately by invoking the Kolmogorov superposition theorem. Indeed, since we are restricting ourselves to \([0,1]^d\), we can uniformly approximate every function that appears in \((2)\) with \(\rho\) with appropriate weights and biases. \(\square\)</p> <p>While the activation function constructed in the above proof doesn’t have many nice properties, activation functions that achieve the same result can be constructed with more complex constructions that are real analytic, strictly increasing, and sigmoidal (in the sense that \(\lim_{x \to -\infty} \rho(x) = 0\) and \(\lim_{x \to \infty} \rho(x) = 1\)). For such a construction, we refer the reader to Section 2 of <d-cite key="maiorov1999lower"></d-cite>. We additionally remark that in this more complicated construction, the main idea of encoding every single polynomial with rational coefficients within the activation function remains. Another similar construction appears in Theorem 5.10 of <d-cite key="ismailov2020notes"></d-cite>.</p> <h2 id="implications-to-statistical-learning">Implications to statistical learning</h2> <p>We will now recall the usual example of a finite-parameter hypothesis space with infinite VC dimension. Consider set of (one-dimensional) classifiers</p> \[\mathcal{F} := \{f_\theta \: : \: f_\theta(x) = \mathrm{sgn}(\sin(\theta x))\}.\] <p>It’s easy to verify that \(\mathcal{F}\) can shatter any data set, and so \(\mathcal{F}\) has infinite VC dimension, yet the classifiers are parameterized by a single real number. The main drawback of this example is that it only works for one-dimensional data sets.</p> <p>With Theorem 1 in hand, we can now state a new example of a parameterized hypothesis space whose VC dimension is infinite, although the dimension of the parameter space is finite. In particular, the example we will construct applies to data sets of any dimension. Moreoever, the dimension of the parameter space is proportional to the dimension of the data set.</p> <p>Consider any data set \( \{ (\mathbf{x}_n, y_n) \}_{n=1}^N \subset \mathbb{R}^d \times \{-1, +1\} \) where \(\Omega \subset \mathbb{R}^d\) is compact. Clearly any such data set can be shattered by</p> \[\{ \tilde{f} \: : \: \tilde{f} = \mathrm{sgn}(f), f \in C(\mathcal{CH}(\{\mathbf{x}_n\}_{n=1}^N)) \}\] <p>where \(\mathcal{CH}(\cdot)\) is the convex hull and \( C(\mathcal{CH}(\{\mathbf{x}_n\}_{n=1}^N)) \) is the space of continuous functions defined on the convex hull of \(\{\mathbf{x}_n\}_{n=1}^N\). The argument is to choose \(f\) so that \(f\) interpolates the data set (choose your favorite spline). Next, since \(\mathcal{CH}(\{\mathbf{x}_n\}_{n=1}^N)\) is compact, by Theorem 1 we know that there exists a two-hidden layer neural network that is \(\varepsilon\) close at every input (at least on \(\mathcal{CH}(\{\mathbf{x}_n\}_{n=1}^N)\), which is all that matters for the sake of the argument), for any \(\varepsilon &gt; 0\). This means the set</p> \[\{ \tilde{f} \: : \: \tilde{f} = \mathrm{sgn}(f), f \in \mathsf{2NN}_\rho^{K_1, K_2} \}\] <p>with \(K_1\), \(K_2\), and \(\rho\) as in Theorem 1 also shatters every data set. Thus we see that two-hidden layer neural networks with \(O(d)\) width and a specially chosen activation function have infinite VC dimension.</p> <p>While this result may seem contradictory, since there are many results regarding the VC dimension of neural networks that would say otherwise, there is no contradiction since the networks considered in the above example have a specially chosen activation function. Indeed, it’s easy to verify that the set of classifiers defined by \(x \mapsto \mathrm{sgn}(\rho(wx - b))\) can shatter any one-dimensional dataset for appropriate choice of \(w, b \in \mathbb{R}\).</p> <h2 id="takeaway-messages">Takeaway messages</h2> <ul> <li> <p>Function compositions provide the ability to approximate or represent many functions with only few parameters, as evidenced by the Kolmogorov superposition theorem. This is perhaps a heuristic for explaining why depth matters in neural networks.</p> </li> <li> <p>When discussing VC dimension of neural networks, it is important to discuss the VC dimension of the activation function itself. Indeed, the only reason the argument in <a href="#implications-to-statistical-learning">Implications to statistical learning</a> follows is because the VC dimension of the activation function is itself infinite.</p> </li> <li> <p>There is a large gap between the capabilities of single-hidden layer and two-hidden layer neural networks, and this gap is still not very well understood.</p> </li> </ul> </d-article> <d-appendix> <d-footnote-list></d-footnote-list> <d-citation-list></d-citation-list> </d-appendix> <d-bibliography src="/assets/bibliography/2020-08-21-surprising-properties-two-hidden-layer-neural-networks.bib"></d-bibliography> </div> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script async src="https://www.googletagmanager.com/gtag/js?id=G-5FW68RKLGW"></script> <script>function gtag(){window.dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-5FW68RKLGW");</script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>addBackToTop();</script> </body> </html>